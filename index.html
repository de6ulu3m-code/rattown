<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ĞšÑ€Ñ‹ÑĞ¾-Ğ“Ñ€Ğ°Ğ´: Ğ¡Ğ¸Ñ‚Ğ¸-ĞœĞµĞ½ĞµĞ´Ğ¶ĞµÑ€</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Color+Emoji&display=swap" rel="stylesheet">
    <style>
        :root { --gold: #ffcc00; --bg: #222; --blue: #4a69bd; --sewer: #3d3d3d; --island: #e67e22; --stadium: #2ecc71; --hospital: #e74c3c; }
        body {
            background-color: var(--bg); color: white;
            font-family: 'Noto Color Emoji', 'Courier New', monospace; 
            display: flex;
            flex-direction: column; align-items: center; margin: 0; min-height: 100vh;
        }
        .city-header {
            background: #111; width: 100%; text-align: center;
            padding: 15px; border-bottom: 3px solid var(--gold);
        }
        .container {
            width: 90%; max-width: 400px; text-align: center; margin-top: 20px;
        }
        
        #market-game {
            background: #333; border: 3px dashed var(--gold);
            height: 300px; position: relative; overflow: hidden;
            display: none; cursor: crosshair; margin-top: 10px;
        }
        .falling-item {
            position: absolute; font-size: 30px; cursor: pointer;
            user-select: none; transition: top 0.1s linear;
        }
        
        .stat-bar { font-size: 1.2rem; margin: 10px 0; color: var(--gold); }
        .btn {
            background: #555; color: white; border: none; padding: 10px 20px;
            border-radius: 5px; cursor: pointer; margin: 5px;
            font-family: 'Noto Color Emoji', 'Courier New', monospace;
            transition: 0.2s;
        }
        .btn:hover { background: var(--gold); color: black; }
        
        /* Ğ¡Ñ‚Ğ¸Ğ»Ğ¸ Ğ½Ğ¾Ğ²Ñ‹Ñ… Ğ·Ğ¾Ğ½ */
        #cityhall-view, #sewer-view, #island-view, #stadium-view, #hospital-view, #skyscraper-view, #park-view { 
            display: none; padding: 20px; border: 3px solid var(--gold); border-radius: 15px; 
        }
        #cityhall-view { background: #2c3e50; }
        #sewer-view { background: #1a1a1a; border-color: #555; }
        #island-view { background: #f1c40f; color: black; border-color: var(--island); }
        #stadium-view { background: #1b5e20; border-color: var(--stadium); }
        #hospital-view { background: #fdfdfd; color: #c0392b; border-color: var(--hospital); }

        .upgrade-card { background: rgba(0,0,0,0.3); padding: 10px; margin: 10px 0; border-radius: 8px; border-left: 4px solid var(--gold); text-align: left; }
    </style>
</head>
<body>

<div class="city-header">
    <h1>ğŸ™ï¸ ĞšĞ Ğ«Ğ¡Ğ-Ğ“Ğ ĞĞ”</h1>
    <div class="stat-bar">Ğ¡Ñ‹Ñ€ Ğ² ĞºĞ°Ñ€Ğ¼Ğ°Ğ½Ğµ: <span id="balance">0</span> ğŸ§€</div>
    <div style="font-size: 0.8rem; color: #2ecc71;">Ğ”Ğ¾Ñ…Ğ¾Ğ´: +<span id="tax-val">0</span> ğŸ§€/5Ñ</div>
</div>

<div class="container" id="main-view">
    <div id="mayor-section">
        <div style="font-size: 50px;">ğŸ¹ğŸ‘”</div>
        <p id="mayor-msg">"Ğ“Ğ¾Ñ€Ğ¾Ğ´ Ñ€Ğ°ÑÑ‚Ñ‘Ñ‚! ĞŸĞ¾Ğ¼Ğ¾Ğ³Ğ¸ Ğ¶Ğ¸Ñ‚ĞµĞ»ÑĞ¼ Ğ¸Ğ»Ğ¸ Ğ¾Ñ‚Ğ¿Ñ€Ğ°Ğ²ÑŒÑÑ Ğ² Ğ¿Ñ€Ğ¸ĞºĞ»ÑÑ‡ĞµĞ½Ğ¸Ğµ."</p>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px;">
            <button class="btn" onclick="startMarketGame()">ğŸ ĞĞ° Ñ€Ñ‹Ğ½Ğ¾Ğº</button>
            <button class="btn" onclick="openCityHall()" style="background: var(--blue);">ğŸ›ï¸ Ğ’ ĞœÑÑ€Ğ¸Ñ</button>
            <button class="btn" onclick="openSkyscraper()">ğŸ¢ ĞĞµĞ±Ğ¾ÑĞºÑ€ĞµĞ±</button>
            <button class="btn" onclick="openPark()">ğŸŒ³ Ğ’ ĞŸĞ°Ñ€Ğº</button>
            <button class="btn" onclick="openStadium()" style="background: var(--stadium);">ğŸŸï¸ Ğ¡Ñ‚Ğ°Ğ´Ğ¸Ğ¾Ğ½</button>
            <button class="btn" onclick="openHospital()" style="background: var(--hospital); color: white;">ğŸ¥ Ğ‘Ğ¾Ğ»ÑŒĞ½Ğ¸Ñ†Ğ°</button>
            <button class="btn" onclick="openSewer()" style="background: var(--sewer);">ğŸ•³ï¸ ĞšĞ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ</button>
            <button class="btn" onclick="openAirport()" style="background: #a29bfe; color: black;">âœˆï¸ ĞÑÑ€Ğ¾Ğ¿Ğ¾Ñ€Ñ‚</button>
        </div>

        <div style="margin-top: 20px; border-top: 1px solid #444; padding-top: 15px;">
            <button class="btn" onclick="window.location.href='/ratbar/'" style="background: #5d4037;">ğŸ» Ğ‘Ğ°Ñ€</button>
            <button class="btn" onclick="window.location.href='/ratmetro/'" style="background: #111; color: var(--gold);">ğŸš‡ ĞœĞµÑ‚Ñ€Ğ¾</button>
            <button class="btn" onclick="saveGame(); alert('ĞŸÑ€Ğ¾Ğ³Ñ€ĞµÑÑ ÑĞ¾Ñ…Ñ€Ğ°Ğ½ĞµĞ½!');" style="background: #00d2d3; color: black;">ğŸ¦ Ğ¡ĞµĞ¹Ñ„</button>
        </div>

        <button class="btn" onclick="resetGame()" style="background: #ff4444; margin-top: 30px; font-size: 0.7rem;">âš ï¸ Ğ¡Ğ±Ñ€Ğ¾Ñ</button>
    </div>
</div>

<div class="container" id="stadium-view">
    <h2>ğŸŸï¸ ĞšÑ€Ñ‹ÑĞ¾-ĞÑ€ĞµĞ½Ğ°</h2>
    <div style="font-size: 50px;">ğŸğŸƒ</div>
    <p>Ğ—Ğ´ĞµÑÑŒ Ğ¿Ñ€Ğ¾Ñ…Ğ¾Ğ´ÑÑ‚ ĞºÑ€Ñ‹ÑĞ¸Ğ½Ñ‹Ğµ Ğ±ĞµĞ³Ğ°!</p>
    <button class="btn" onclick="trainTail()" style="width:100%;">ğŸ’ª Ğ¢Ñ€ĞµĞ½Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ñ…Ğ²Ğ¾ÑÑ‚ (10 ğŸ§€)<br><small>+2 â­ Ğ ĞµĞ¿ÑƒÑ‚Ğ°Ñ†Ğ¸Ğ¸</small></button>
    <button class="btn" onclick="exitView('stadium-view')" style="width:100%; margin-top:10px;">ĞĞ°Ğ·Ğ°Ğ´ Ğ² Ğ³Ğ¾Ñ€Ğ¾Ğ´</button>
</div>

<div class="container" id="hospital-view">
    <h2>ğŸ¥ Ğ“Ğ¾ÑĞ¿Ğ¸Ñ‚Ğ°Ğ»ÑŒ "Ğ—ÑƒĞ±Ğ¸Ğº"</h2>
    <div style="font-size: 50px;">ğŸš‘ğŸ’Š</div>
    <p>Ğ’Ñ‹Ğ»ĞµÑ‡Ğ¸Ğ¼ Ğ»ÑĞ±Ğ¾Ğ¹ Ñ…Ğ²Ğ¾ÑÑ‚Ğ¸Ğº!</p>
    <button class="btn" onclick="buyVitamins()" style="background: #e74c3c; color:white; width:100%;">ğŸ Ğ’Ğ¸Ñ‚Ğ°Ğ¼Ğ¸Ğ½Ñ‹ (25 ğŸ§€)<br><small>+5 â­ Ğ ĞµĞ¿ÑƒÑ‚Ğ°Ñ†Ğ¸Ğ¸</small></button>
    <button class="btn" onclick="exitView('hospital-view')" style="width:100%; margin-top:10px;">Ğ’Ñ‹Ğ¹Ñ‚Ğ¸</button>
</div>

<div class="container" id="game-view" style="display:none;">
    <h3>Ğ›Ğ¾Ğ²Ğ¸ ĞµĞ´Ñƒ! ĞÑÑ‚Ğ°Ğ»Ğ¾ÑÑŒ: <span id="timer">15</span>Ñ</h3>
    <div id="market-game"></div>
</div>

<div class="container" id="cityhall-view">
    <h2 style="color: var(--gold);">ğŸ›ï¸ ĞœÑÑ€Ğ¸Ñ</h2>
    <p>Ğ’Ğ°Ñˆ ÑÑ‚Ğ°Ñ‚ÑƒÑ: <b id="rank-name">ĞŸÑ€Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ğ¹</b></p>
    <div class="upgrade-card">
        <div>ğŸ’¡ Ğ£Ğ»Ğ¸Ñ‡Ğ½Ğ¾Ğµ Ğ¾ÑĞ²ĞµÑ‰ĞµĞ½Ğ¸Ğµ</div>
        <small>Ğ”Ğ¾Ñ…Ğ¾Ğ´ +1 ğŸ§€/5Ñ</small>
        <button class="btn" onclick="upgradeCity('lights', 50)" style="float:right; padding:5px;">50 ğŸ§€</button>
    </div>
    <button class="btn" onclick="exitView('cityhall-view')" style="width:100%; margin-top:10px;">ĞĞ°Ğ·Ğ°Ğ´</button>
</div>

<div class="container" id="sewer-view">
    <h2 style="color: #888;">ğŸ•³ï¸ ĞšĞ°Ğ½Ğ°Ğ»Ğ¸Ğ·Ğ°Ñ†Ğ¸Ñ</h2>
    <div style="font-size: 50px;">ğŸšï¸ğŸ</div>
    <button class="btn" onclick="rescueMouse(100)" style="background: #2ecc71; width:100%;">ğŸ  ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ Ğ´Ğ¾Ğ¼ (100 ğŸ§€)</button>
    <button class="btn" onclick="exitView('sewer-view')" style="width:100%; margin-top:20px;">ĞĞ°Ğ²ĞµÑ€Ñ…</button>
</div>

<div class="container" id="island-view">
    <h2>ğŸï¸ Ğ‘ĞµÑˆĞµĞ½Ñ‹Ğ¹ ĞÑÑ‚Ñ€Ğ¾Ğ²</h2>
    <button class="btn" onclick="searchGoldCheese()" style="background: var(--island); color: white; width:100%;">Ğ˜ÑĞºĞ°Ñ‚ÑŒ Ğ—Ğ¾Ğ»Ğ¾Ñ‚Ğ¾Ğ¹ Ğ¡Ñ‹Ñ€ ğŸ§€âœ¨</button>
    <button class="btn" onclick="exitView('island-view')" style="width:100%; margin-top:20px; background: #c0392b;">Ğ£Ğ»ĞµÑ‚ĞµÑ‚ÑŒ âœˆï¸</button>
</div>

<div class="container" id="skyscraper-view">
    <h2 id="floor-title">ğŸ¢ ĞĞµĞ±Ğ¾ÑĞºÑ€ĞµĞ±</h2>
    <div id="floor-content">ğŸ›ï¸ ĞšÑƒĞ´Ğ° ĞµĞ´ĞµĞ¼?</div>
    <button class="btn" onclick="goFloor(3)">ĞŸĞµĞ½Ñ‚Ñ…Ğ°ÑƒÑ</button>
    <button class="btn" onclick="exitView('skyscraper-view')">Ğ’Ñ‹Ñ…Ğ¾Ğ´</button>
</div>

<div class="container" id="park-view">
    <h2>ğŸŒ³ ĞŸĞ°Ñ€Ğº</h2>
    <div id="pigeon-icon" style="font-size: 50px;">ğŸ¦</div>
    <p>Ğ ĞµĞ¿ÑƒÑ‚Ğ°Ñ†Ğ¸Ñ: <span id="rep-count">0</span> â­</p>
    <button class="btn" onclick="feedBirds()">ĞšĞ¾Ñ€Ğ¼Ğ¸Ñ‚ÑŒ (5ğŸ§€)</button>
    <button class="btn" onclick="exitView('park-view')">Ğ’Ñ‹Ğ¹Ñ‚Ğ¸</button>
</div>

<script>
    let cheeseBalance = 0;
    let reputation = 0;
    let hasPenthouse = false;
    let cityLights = 0;
    let cityRoads = 0;
    let taxIncome = 0;
    let gameActive = false;
    let timeLeft = 15;

    function saveGame() {
        localStorage.setItem('ratCheese', cheeseBalance);
        localStorage.setItem('ratRep', reputation);
        localStorage.setItem('ratPenthouse', hasPenthouse);
        localStorage.setItem('ratLights', cityLights);
        localStorage.setItem('ratRoads', cityRoads);
    }

    function loadGame() {
        cheeseBalance = parseInt(localStorage.getItem('ratCheese')) || 0;
        reputation = parseInt(localStorage.getItem('ratRep')) || 0;
        cityLights = parseInt(localStorage.getItem('ratLights')) || 0;
        cityRoads = parseInt(localStorage.getItem('ratRoads')) || 0;
        hasPenthouse = localStorage.getItem('ratPenthouse') === 'true';
        calculateTaxes();
        updateDisplay();
    }

    function updateDisplay() {
        document.getElementById('balance').innerText = cheeseBalance;
        document.getElementById('tax-val').innerText = taxIncome;
        let repSpan = document.getElementById('rep-count');
        if(repSpan) repSpan.innerText = reputation;
    }

    function calculateTaxes() {
        taxIncome = (cityLights * 1) + (cityRoads * 4) + Math.floor(reputation / 10);
    }

    setInterval(() => {
        if (taxIncome > 0) {
            cheeseBalance += taxIncome;
            updateDisplay();
        }
    }, 5000);

    function exitView(viewId) {
        document.getElementById(viewId).style.display = 'none';
        document.getElementById('main-view').style.display = 'block';
    }

    // ĞĞĞ’Ğ«Ğ• Ğ¤Ğ£ĞĞšĞ¦Ğ˜Ğ˜
    function openStadium() {
        document.getElementById('main-view').style.display = 'none';
        document.getElementById('stadium-view').style.display = 'block';
    }

    function trainTail() {
        if (cheeseBalance >= 10) {
            cheeseBalance -= 10;
            reputation += 2;
            alert("Ğ¥Ğ²Ğ¾ÑÑ‚ ÑÑ‚Ğ°Ğ» ĞºÑ€ĞµĞ¿Ñ‡Ğµ! Ğ ĞµĞ¿ÑƒÑ‚Ğ°Ñ†Ğ¸Ñ +2 â­");
            updateDisplay();
            saveGame();
        } else { alert("ĞÑƒĞ¶Ğ½Ğ¾ Ğ±Ğ¾Ğ»ÑŒÑˆĞµ ÑÑ‹Ñ€Ğ°!"); }
    }

    function openHospital() {
        document.getElementById('main-view').style.display = 'none';
        document.getElementById('hospital-view').style.display = 'block';
    }

    function buyVitamins() {
        if (cheeseBalance >= 25) {
            cheeseBalance -= 25;
            reputation += 5;
            alert("Ğ’Ğ¸Ñ‚Ğ°Ğ¼Ğ¸Ğ½ĞºĞ¸ Ğ²ĞºÑƒÑĞ½Ñ‹Ğµ! Ğ—Ğ´Ğ¾Ñ€Ğ¾Ğ²ÑŒĞµ Ğ² Ğ½Ğ¾Ñ€Ğ¼Ğµ, Ñ€ĞµĞ¿ÑƒÑ‚Ğ°Ñ†Ğ¸Ñ +5 â­");
            updateDisplay();
            saveGame();
        } else { alert("ĞĞµ Ñ…Ğ²Ğ°Ñ‚Ğ°ĞµÑ‚ ÑÑ‹Ñ€Ğ° Ğ½Ğ° Ğ»ĞµÑ‡ĞµĞ½Ğ¸Ğµ!"); }
    }

    // Ğ›ĞĞ“Ğ˜ĞšĞ Ğ˜Ğ— ĞĞ Ğ˜Ğ“Ğ˜ĞĞĞ›Ğ
    function openSewer() { document.getElementById('main-view').style.display = 'none'; document.getElementById('sewer-view').style.display = 'block'; }
    function rescueMouse(cost) { if (cheeseBalance >= cost) { cheeseBalance -= cost; reputation += 20; alert("ĞœÑ‹ÑˆĞ¸ ÑĞ¿Ğ°ÑĞµĞ½Ñ‹!"); saveGame(); updateDisplay(); } else { alert("ĞœĞ°Ğ»Ğ¾ ÑÑ‹Ñ€Ğ°!"); } }
    function openAirport() { if (confirm("Ğ‘Ğ¸Ğ»ĞµÑ‚ ÑÑ‚Ğ¾Ğ¸Ñ‚ 50 ğŸ§€. Ğ›ĞµÑ‚Ğ¸Ğ¼?")) { if (cheeseBalance >= 50) { cheeseBalance -= 50; document.getElementById('main-view').style.display = 'none'; document.getElementById('island-view').style.display = 'block'; updateDisplay(); } else { alert("ĞĞµÑ‚ ÑÑ‹Ñ€Ğ°!"); } } }
    function searchGoldCheese() { let r = Math.random(); if (r > 0.6) { let win = Math.floor(Math.random() * 100) + 50; cheeseBalance += win; alert("ĞĞ°ÑˆĞµĞ» ÑÑ‹Ñ€: " + win); } else { alert("Ğ‘ĞµÑˆĞµĞ½Ñ‹Ğµ ĞºÑ€Ñ‹ÑÑ‹ Ğ¿Ğ¾ĞºÑƒÑĞ°Ğ»Ğ¸ Ğ²Ğ°Ñ!"); } saveGame(); updateDisplay(); }
    function openCityHall() { document.getElementById('main-view').style.display = 'none'; document.getElementById('cityhall-view').style.display = 'block'; updateCityHallUI(); }
    function updateCityHallUI() { calculateTaxes(); let rank = "ĞŸÑ€Ğ¾Ñ…Ğ¾Ğ¶Ğ¸Ğ¹"; if (reputation > 5) rank = "ĞœĞµÑÑ‚Ğ½Ñ‹Ğ¹"; document.getElementById('rank-name').innerText = rank; }
    function upgradeCity(type, cost) { if (cheeseBalance >= cost) { cheeseBalance -= cost; if (type === 'lights') cityLights++; calculateTaxes(); saveGame(); updateCityHallUI(); updateDisplay(); } }
    function startMarketGame() { document.getElementById('main-view').style.display = 'none'; document.getElementById('game-view').style.display = 'block'; document.getElementById('market-game').style.display = 'block'; gameActive = true; timeLeft = 15; spawnItems(); let timerFunc = setInterval(() => { timeLeft--; document.getElementById('timer').innerText = timeLeft; if (timeLeft <= 0) { clearInterval(timerFunc); endGame(); } }, 1000); }
    function spawnItems() { if (!gameActive) return; const gameZone = document.getElementById('market-game'); const item = document.createElement('div'); item.className = 'falling-item'; item.innerText = 'ğŸ§€'; item.style.left = Math.random() * (gameZone.offsetWidth - 30) + 'px'; item.style.top = '-40px'; gameZone.appendChild(item); let fall = setInterval(() => { let top = parseInt(item.style.top); if (top > 300 || !gameActive) { clearInterval(fall); if (item.parentNode) gameZone.removeChild(item); } else { item.style.top = (top + 5) + 'px'; } }, 30); item.onclick = () => { cheeseBalance += 2; updateDisplay(); clearInterval(fall); if (item.parentNode) gameZone.removeChild(item); }; setTimeout(spawnItems, 600); }
    function endGame() { gameActive = false; document.getElementById('market-game').innerHTML = ''; exitView('game-view'); saveGame(); }
    function openSkyscraper() { document.getElementById('main-view').style.display = 'none'; document.getElementById('skyscraper-view').style.display = 'block'; }
    function goFloor(num) { if (num === 3) { if (hasPenthouse) document.getElementById('floor-content').innerHTML = "ğŸ‘‘ Ğ’Ğ°ÑˆĞ¸ Ğ¿Ğ¾ĞºĞ¾Ğ¸"; else document.getElementById('floor-content').innerHTML = "<button onclick='buyPenthouse()'>ĞšÑƒĞ¿Ğ¸Ñ‚ÑŒ Ğ·Ğ° 200</button>"; } }
    function buyPenthouse() { if (cheeseBalance >= 200) { cheeseBalance -= 200; hasPenthouse = true; saveGame(); updateDisplay(); goFloor(3); } }
    function openPark() { document.getElementById('main-view').style.display = 'none'; document.getElementById('park-view').style.display = 'block'; }
    function feedBirds() { if (cheeseBalance >= 5) { cheeseBalance -= 5; reputation += 1; updateDisplay(); saveGame(); } }
    function resetGame() { if (confirm("Ğ¡Ğ±Ñ€Ğ¾ÑĞ¸Ñ‚ÑŒ?")) { localStorage.clear(); location.reload(); } }
    window.onload = loadGame;
</script>
</body>
</html>
